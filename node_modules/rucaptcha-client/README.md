# rucaptcha-client
Простой клиент для https://rucaptcha.com на node.js.

## Установка
`npm install image-binary rucaptcha-client`

## Пример
```javascript
const apiKey = 'Ваш ключ API';
const Image = require('image-binary');
const client = require('rucaptcha-client').create(apiKey);

let balance;

client.balance
	.then((num) => {
		balance = num;
		return Image.create(uri);
	})
	.then((image) => {
		client.image = image;
		return client.solve({
			language: 2,
			regsense: 2
		});
	})
	.then((answer) => {
		console.log(
			'Баланс: ' + balance + '\n' +
			'Ответ: ' + answer.text
		);
	});
```

## Пример async-await
```javascript
const apiKey = 'Ваш ключ API';
const Image = require('image-binary');
const client = require('rucaptcha-client').create(apiKey);

(async function run() {
	let balance = await client.balance;
	let answer = await client.solve({
	    image: await Image.create(uri),
	    language: 2,
	    regsense: 2
	});
	
	console.log(
		'Баланс: ' + balance + '\n' +
		'Ответ: ' + answer.text
	);
	
	// Если ответ неверный, можно отправить жалобу...
	await client.report(answer.id);
})();
```

## Конструктор
`new RuCaptchaClient(String apiKey);`<br>
`RuCaptchaClient.create(String apiKey);`<br>
**apiKey** - Ваш ключ API. Узнайте его здесь: https://rucaptcha.com/setting

## Свойства
**Image image** - картинка с капчей. Подробнее: https://github.com/IvanPodgornov/Image<br>
**Promise&lt;String&gt; balance** - ваш баланс

## Методы
### `async report(captchaID);`
Отправляет жалобу на неправильный ответ.<br>
В случае успешного запроса, вернёт true. Иначе выбросит ошибку с описанием.

### `async solve(options = {});`
Возвращает объект в котором свойству id соответствует id решенной капчи. Этот id после можно использовать для жалобы на неправильный ответ. А свойство text возвращаемого объекта соответствует тексту на картинке.<br>
В качестве options можно передать следующие значения:<br>
* phrase (По умолчанию: 0)<br>
0 - капча состоит из одного слова.<br>
1 - капча состоит из двух или более слов

* regsense (По умолчанию: 0)<br>
0 - капча не чувствительна к регистру<br>
1 - капча чувствительна к регистру

* numeric (По умолчанию: 0)<br>
0 - не определено<br>
1 - капча состоит только из цифр<br>
2 - капча состоит только из букв<br>
3 - капча состоит либо только из букв, либо только из цифр<br>
4 - в капче могут быть и буквы и цифры

* calc (По умолчанию: 0)<br>
0 - не определено<br>
1 - капча требует совершения математического действия (например: напишите результат 4 + 8 = )

* minLen (По умолчанию: 0)<br>
0 - не определено<br>
1..20 - минимальное количество символов в ответе

* maxLen (По умолчанию: 0)<br>
0 - не определено<br>
1..20 - максимальное количество символов в ответе

* regsense (По умолчанию: 0)<br>
0 - капча не чувствительна к регистру<br>
1 - капча чувствительна к регистру

* language (По умолчанию: 0)<br>
0 - не определено<br>
1 - капча содержит только кириллицу<br>
2 - капча содержит только латиницу<br>

* textInstructions<br>
Текст будет показан работнику, чтобы помочь ему правильно решить капчу.

* imgInstructions<br>
Изображение будет показано работнику, чтобы помочь ему решить капчу правильно.
Пока можно вставить только base64 код изображения.

* headerAcao(По умолчанию: 0)<br>
0 - выключен<br>
1 - включен<br>
Используется для кроссдоменных AJAX-запросов из веб-приложений.

* pingback<br>
URL для автоматической отправки ответа на капчу